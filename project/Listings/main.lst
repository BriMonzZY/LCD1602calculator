C51 COMPILER V9.60.0.0   MAIN                                                              03/23/2021 13:30:16 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\output\main.obj
COMPILER INVOKED BY: D:\app\keilC51\C51\BIN\C51.EXE ..\source_files\main.c COMPACT OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECT
                    -EXTEND PRINT(.\Listings\main.lst) TABS(2) OBJECT(..\output\main.obj)

line level    source

   1          /**
   2           * @project         LCD1602 caculator
   3           * @author          BriMonzZY (1610937885@qq.com)
   4           * @brief           caculator based on 51
   5           * @version         0.1
   6           * @date            2021-03-22
   7           * @paltform        STC89C52 & STC89C52RC
   8           * @copyright       Copyright (c) 2021
   9           * 
  10           *
  11           *
  12           * 矩阵按键功能：
  13           *
  14           * 7      8     9     ÷
  15           * 4      5     6     x
  16           * 1      2     3     -
  17           * 退格   0     =     +
  18           *
  19           *
  20           *
  21           *
  22           *
  23           * 键值对应：
  24           * 
  25           * 0  1   2   3 
  26           * 4  5   6   7
  27           * 8  9   10  11
  28           * 12 13  14  15
  29           *
  30           */
  31          #define __MAIN_C
  32          #include "config.h"
  33          #include "main.h"
  34          #include "lcd1602.h"
  35          #include "app.h"
  36          #include "key.h"
  37          
  38          
  39          
  40          
  41          void timer0Init();
  42          bit keyjudge = 0;
  43          uint8 cursor1;
  44          uint8 cursor2; // LCD 第一行位置指针， 第二行位置指针
  45          float num_in_buff = 0.1;
  46          char str[40];  //存储输入的中缀表达式
  47          
  48          
  49          uchar backup[4][4] = { //初始化按键值备份
  50                {1, 1, 1, 1}, {1, 1, 1, 1}, {1, 1, 1, 1}, {1, 1, 1, 1}
  51          };
  52          
  53          
  54          #define INITSIZE  20
C51 COMPILER V9.60.0.0   MAIN                                                              03/23/2021 13:30:16 PAGE 2   

  55          #define INCREMENT 10
  56          #define MAXBUFFER 20
  57          #define LEN  sizeof(Elemtype)
  58          /*栈的动态分配存储结构*/ 
  59          //typedef char Elemtype;
  60          //struct SqStack{
  61          //  Elemtype *base;
  62          //  Elemtype *top;
  63          //  int StackSize;
  64          //};
  65          
  66          typedef struct SqStack{
  67            Elemtype *base;
*** ERROR C141 IN LINE 67 OF ..\source_files\main.c: syntax error near 'Elemtype', expected 'bit'
*** ERROR C129 IN LINE 67 OF ..\source_files\main.c: missing ';' before '*'
  68            Elemtype *top;
  69            int StackSize;
  70          }SqStack;
  71          
  72          SqStack S;
  73          
  74          
  75          /**
  76           * @brief   主函数
  77           * @param   无
  78           * @return  无
  79           */
  80          void main()
  81          {
  82            timer0Init(); // 初始化定时器0中断
  83            Init_LCD1602();
  84            LCD1602_Clear_Screen();
  85            LCD1602_Dis_Str(0, 0, "Welcome");
  86            while(1) {
  87              keydriver(); // 循环检测按键
  88              
  89            }
  90          }
  91          
  92          /**
  93           * @brief 定时器0中断服务函数
  94           * 
  95           * @param   无 
  96           * @return  无 
  97           */
  98          void timer0() interrupt 1
  99          {
 100            TH0 = 0xfc; //重新加载初值1ms
 101            TL0 = 0x66;
 102            keyscan();
 103          }
 104          
 105          /**
 106           * @brief 定时器中断0初始化函数
 107           * 
 108           * @param   无
 109           * @return  无 
 110           */
 111          void timer0Init()
 112          {
 113            EA = 1;
 114            TMOD = 0x01; //设置 T0 为模式 1
C51 COMPILER V9.60.0.0   MAIN                                                              03/23/2021 13:30:16 PAGE 3   

 115            TH0 = 0xfc; //为 T0 赋初值 0xFC67，定时 1ms
 116            TL0 = 0x66;
 117            ET0 = 1; //使能 T0 中断
 118            TR0 = 1; //启动 T0
 119          }

C51 COMPILATION COMPLETE.  0 WARNING(S),  2 ERROR(S)
